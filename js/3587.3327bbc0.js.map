{"version":3,"file":"js/3587.3327bbc0.js","mappings":"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","sources":["webpack://gachivue0.4/./src/components/SessionUploadPic.vue","webpack://gachivue0.4/./src/components/SessionUploadPic.vue?6d9b"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"form-group center\">\r\n      <input type=\"file\" @change=\"fileChange\" ref=\"fileInput\" class=\"form-control\" multiple />\r\n      <label ref=\"fileLabel\" class=\"custom-file-label\" data-browse=\"Browse\"></label>\r\n    </div>\r\n    <div class=\"uploadResult\">\r\n      <ul ref=\"upResult\"></ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport { reactive, ref } from '@vue/reactivity'\r\n\r\nexport default {\r\n  name: 'SessionUploadPic',\r\n  props: [],\r\n  data() { return {} },\r\n  setup() {\r\n    const regex = new RegExp(\"(.*?).(exe|sh|zip|alz|tiff)$\");\r\n    const maxSize = 1024 * 1024 * 10; //10MB\r\n    const state = reactive({\r\n      fileInput: '',\r\n      fileLabel: '',\r\n      upResult: '',\r\n      token: sessionStorage.getItem(\"TOKEN\"),\r\n    })\r\n    const fileInput = ref('')\r\n    const fileLabel = ref('')\r\n    const upResult = ref('')\r\n\r\n    const checkExtension = (fileName, fileSize) => {\r\n      if (fileSize > maxSize) {\r\n        alert('파일사이즈초과')\r\n        return false;\r\n      }\r\n      if (regex.test(fileName)) {\r\n        alert('해당파일은 업로드 될 수 없습니다.')\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n    const fileChange = async () => {\r\n      const fileName = fileInput.value.value.split(\"\\\\\").pop() //맨끝만 나옴.\r\n      console.log(fileName)\r\n      fileLabel.value.innerHTML = (fileInput.value.files.length - 1) == 0 ? \"\" :\r\n        fileName + \" 외 \" + (fileInput.value.files.length - 1) + \"개\";\r\n\r\n      var formData = new FormData();\r\n      var files = fileInput.value.files;\r\n      var appended = false;\r\n\r\n      for (let i = 0; i < files.length; i++) {\r\n        if (!checkExtension(files[i].name, files[i].size)) {\r\n          fileLabel.value.innerHTML = \"\"\r\n          this.value = ''\r\n          return false;\r\n        }\r\n        formData.append(\"uploadFiles\", files[i]);\r\n        appended = true;\r\n      }\r\n\r\n      //전송할 파일이 없으면 여기서 끝.If there are no files to transfer, end here.\r\n      if (!appended) return;\r\n\r\n      //전송할 파일이 있으면 목록 보기.It there are files to transfer,show list.\r\n      for (let value of formData.values()) console.log(value)\r\n\r\n      const url = 'http://43.201.60.125/api/uploadAjax/'\r\n      await axios.post(url, formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\",\r\n          \"process-data\": false,\r\n          Authorization: state.token,\r\n          \"token\": state.token\r\n        },\r\n      }).then(function (res) {\r\n        showResult(res.data);\r\n      }).catch(function (err) {\r\n        console.log(err)\r\n      })\r\n    }\r\n    const showResult = async (arr) => {\r\n      const uploadUL = upResult.value;\r\n      const displayUrl = '/display'\r\n      const url = `http://43.201.60.125${displayUrl}`\r\n      let str = \"\"\r\n      for (let i = 0; i < arr.length; i++) {\r\n        str += `\r\n          <li data-name='${arr[i].fileName}' data-path='${arr[i].folderPath}' \r\n              data-uuid='${arr[i].uuid}' data-file='${arr[i].imageURL}'>\r\n            <div>\r\n              <button type='button' class='removeBtn'>X</button>\r\n              <br><img src='${url}?fileName=${arr[i].thumbnailURL}'>\r\n            </div>\r\n          </li>`\r\n      }\r\n      uploadUL.innerHTML = str;\r\n      const removeBtns = document.querySelectorAll(\".removeBtn\");\r\n      for (let i = 0; i < removeBtns.length; i++) {\r\n        removeBtns[i].onclick = function () {\r\n          const removeUrl = 'http://43.201.60.125/api/removeFile'\r\n          const targetLI = this.parentElement.closest('li')\r\n          const fileName = targetLI.dataset.file\r\n          const headers = {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: state.token,\r\n            \"token\": state.token\r\n          }\r\n          axios({\r\n            method: \"POST\",\r\n            url: `${removeUrl}?fileName=${fileName}`,\r\n            headers: headers,\r\n          }).then(function (res) {\r\n            if (res.data === true) targetLI.remove();\r\n          }).catch(function (err) { console.log(err) });\r\n        }\r\n      }\r\n    }\r\n    return { state, fileInput, fileLabel, upResult, fileChange, checkExtension }\r\n  },\r\n}\r\n</script>\r\n  \r\n<style>\r\n.centerz {\r\n  display: inline-block;\r\n  width: 500px;\r\n  text-align: right;\r\n  color: rgb(138, 156, 189);\r\n  margin: 10px 0;\r\n}\r\n\r\n.uploadResult {\r\n  width: 100%;\r\n  background-color: gray;\r\n  margin-top: 10px;\r\n}\r\n\r\n.uploadResult ul {\r\n  display: flex;\r\n  flex-flow: row;\r\n  vertical-align: top;\r\n  overflow: auto;\r\n}\r\n\r\n.uploadResult ul li {\r\n  list-style: none;\r\n  padding: 10px;\r\n  margin-left: 2em;\r\n}\r\n\r\n.uploadResult ul li img {\r\n  width: 100px;\r\n}\r\n</style>\r\n  ","import { render } from \"./SessionUploadPic.vue?vue&type=template&id=10f7640c\"\nimport script from \"./SessionUploadPic.vue?vue&type=script&lang=js\"\nexport * from \"./SessionUploadPic.vue?vue&type=script&lang=js\"\n\nimport \"./SessionUploadPic.vue?vue&type=style&index=0&id=10f7640c&lang=css\"\n\nimport exportComponent from \"D:\\\\DS Portfolio\\\\DS-Nolaboda-Gachi\\\\gachivue0.4\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","ref","_createElementBlock","_createElementVNode","type","onChange","$setup","multiple","name","props","data","setup","regex","RegExp","maxSize","state","reactive","fileInput","fileLabel","upResult","token","sessionStorage","getItem","checkExtension","fileName","fileSize","alert","test","fileChange","async","value","split","pop","console","log","innerHTML","files","length","formData","FormData","appended","i","size","this","append","values","url","axios","headers","Authorization","then","res","showResult","catch","err","uploadUL","displayUrl","str","arr","folderPath","uuid","imageURL","thumbnailURL","removeBtns","document","querySelectorAll","onclick","removeUrl","targetLI","parentElement","closest","dataset","file","method","remove","__exports__","render"],"sourceRoot":""}